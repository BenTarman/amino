#!/usr/bin/env blender -b -P

import bpy
import sys
import os


i_start = sys.argv.index("--")

in_file = sys.argv[i_start+1]
out_file = sys.argv[i_start+2]

# Clear any default objects
for ob in bpy.data.objects:
    print(ob)
    ob.select = True
    bpy.ops.object.delete()

basename, filetype = os.path.splitext(in_file)
filetype = filetype.lower()

# Import File
if (".dae" == filetype):
    print("Loading Collada")
    bpy.ops.wm.collada_import(filepath=in_file)
elif (".stl" == filetype ):
    print("Loading STL")
    bpy.ops.import_mesh.stl(filepath=in_file)
else:
    raise Exception("Unknown file type: " + filetype)


# Export File
# right-handed coordinates, like god intended
bpy.ops.export_scene.obj(filepath=out_file, axis_up='Z', axis_forward='Y')


# Local Variables:
# mode: python
# End:
